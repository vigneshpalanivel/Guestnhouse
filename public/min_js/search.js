var prop_app_fil="",amen_app_fil="",broom_app_fil="",bed_app_fil="",bath_app_fil="",search_on_map="";map_search_first="",$(".map.hide-sm-view").hide(),$(".search-results").show(),$("body").addClass("pos-fixed"),$(".filter-div").hide(),$(".sidebar").scroll(function(){var e=$(".sidebar").scrollTop(),t=$(".filters.collapse").height();e>=t?$(".sidebar-header").addClass("fixed-header"):$(".sidebar-header").removeClass("fixed-header")}),$(window).resize(function(){$(".sidebar-header").removeClass("fixed-header")}),$(".sidebar").scroll(function(){$("#ui-datepicker-div").hide()}),$(".customBox").hover(function(){$(mark).addClass("hover")}),$(document).ready(function(){$("label.toggle .toggle__handle").click(function(){$("label.toggle").toggleClass("toggle--checked");var e="Off"==$("label.toggle .toggle__handle span").text()?"On":"Off";$("label.toggle .toggle__handle span").html(e)})}),app.directive("postsPagination",function(){return{restrict:"E",template:'<ul class="pagination"><li ng-show="currentPage != 1"><a href="javascript:void(0)" ng-click="search_result(1)">&laquo;</a></li><li ng-show="currentPage != 1"><a href="javascript:void(0)" ng-click="search_result(currentPage-1)">&lsaquo; '+$("#pagin_prev").val()+'</a></li><li ng-repeat="i in range" ng-class="{active : currentPage == i}"><a href="javascript:void(0)" ng-click="search_result(i)">{{i}}</a></li><li ng-show="currentPage != totalPages"><a href="javascript:void(0)" ng-click="search_result(currentPage+1)">'+$("#pagin_next").val()+' &rsaquo;</a></li><li ng-show="currentPage != totalPages"><a href="javascript:void(0)" ng-click="search_result(totalPages)">&raquo;</a></li></ul>'}}).controller("search-page",["$scope","$http","$compile","$filter",function(e,t,a,i){function o(){$(window).width()<760?($(document).on("click",".button_ipunk",function(){$(".map.hide-sm-view").show(),$(".search-results").hide(),$("body").addClass("pos-fixed"),$(".button_ipunk").hide(),$(".button_ipunk-result").show(),$(".filter-div").hide(),e.search_result()}),$(".button_ipunk-result").click(function(){$(".button_ipunk").show(),$(".button_ipunk-result").hide(),$(".map.hide-sm-view").hide(),$(".search-results").show(),$(".filter-div").hide()}),$(".button_ipunk4").click(function(){$(".button_ipunk").hide(),$(".button_ipunk-result").hide(),$(".button_ipunk4").hide(),$(".map.hide-sm-view").hide(),$(".search-results").hide(),$(".filter-div").show()})):($(".search-results").show(),$("body").removeClass("pos-fixed"))}function s(){$(window).width()<760&&($(".amenities").change(function(){e.search_result()}),$(".property_type").change(function(){e.search_result()}),$("#map-search-min-bathrooms").change(function(){e.search_result()}),$("#map-search-min-beds").change(function(){e.search_result()}),$("#map-search-min-bedrooms").change(function(){e.search_result()}))}function r(){$(".search-results").hasClass("loading")?$("#no_results").hide():$("#no_results").show()}function n(){"none"==$(".search-results").css("display")&&$(".map").addClass("loading")}function l(){"Yes"==e.first_search&&(e.first_search="No",$(".button_ipunk").show(),$(".button_ipunk-result").hide(),$(".map.hide-sm-view").hide(),$(".search-results").show(),$(".filter-div").hide()),$(".map").removeClass("loading")}function c(e,t){var a=window.location.href;if(a.indexOf(e+"=")>=0){var i=a.substring(0,a.indexOf(e)),o=a.substring(a.indexOf(e));o=o.substring(o.indexOf("=")+1),o=o.indexOf("&")>=0?o.substring(o.indexOf("&")):"",a=i+e+"="+t+o}else a+=a.indexOf("?")<0?"?"+e+"="+t:"&"+e+"="+t;history.pushState(null,null,a)}function d(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),a=t.exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function m(){autocomplete=new google.maps.places.Autocomplete(document.getElementById("header-search-form"),{types:["geocode"]}),google.maps.event.addListener(autocomplete,"place_changed",function(){var t=$("#header-search-form").val(),a=t.replace(" ","+");c("location",a);var i=autocomplete.getPlace(),o=i.geometry.location.lat(),s=i.geometry.location.lng();i&&i.geometry&&i.geometry.viewport&&(e.viewport=e.locationViewport=i.geometry.viewport),e.cLat=e.locationLat=o,e.cLong=e.locationLong=s,e.map_lat_long="",search_on_map="",e.search_result()}),sm_autocomplete1=new google.maps.places.Autocomplete(document.getElementById("header-search-form-mob"),{types:["geocode"]}),google.maps.event.addListener(sm_autocomplete1,"place_changed",function(){$("#header-search-form").val($("#header-search-form-mob").val());var t=$("#header-search-form-mob").val(),a=t.replace(" ","+");c("location",a);var i=sm_autocomplete1.getPlace(),o=i.geometry.location.lat(),s=i.geometry.location.lng();i&&i.geometry&&i.geometry.viewport&&(e.viewport=e.locationViewport=i.geometry.viewport),e.cLat=e.locationLat=o,e.cLong=e.locationLong=s,e.map_lat_long="",search_on_map="",e.search_result()})}function p(t){if(t||(t=""),""==e.zoom)var a=10;else var a=e.zoom;if(0==$("#lat").val())var a=1;if(""==e.cLat&&""==e.cLong)var i=$("#lat").val(),o=$("#long").val();else var i=e.cLat,o=e.cLong;var s=new google.maps.LatLng(i,o),r={scrollwheel:!1,center:s,zoom:a,minZoom:2,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP,style:google.maps.ZoomControlStyle.SMALL},mapTypeControl:!1,streetViewControl:!1,navigationControl:!1,backgroundColor:"#a4ddf5",styles:[{featureType:"water",elementType:"geometry",stylers:[{color:"#a4ddf5"}]}]};Y=new google.maps.Map(document.getElementById("map_canvas"),r),0!=i&&0!=o&&Y.fitBounds(e.viewport),google.maps.event.addListener(Y,"idle",function(){e.map_fit_bounds="",e.zoom=Y.getZoom();var t=Y.getZoom(),a=Y.getBounds(),i=a.getSouthWest().lat(),o=a.getSouthWest().lng(),s=a.getNorthEast().lat(),r=a.getNorthEast().lng(),n=a.getCenter().lat(),l=a.getCenter().lng();e.cLat=a.getCenter().lat(),e.cLong=a.getCenter().lng(),map_display=$(".map").css("display"),"none"!=map_display?e.map_lat_long=t+"~"+a+"~"+i+"~"+o+"~"+s+"~"+r+"~"+n+"~"+l:e.map_lat_long="";var c="";$(".map-auto-refresh-checkbox:checked").each(function(e){c=$(this).val()}),"true"==c||($(".map-auto-refresh").addClass("hide"),$(".map-manual-refresh").removeClass("hide"))});var n=document.createElement("div");new h(n,Y);Y.controls[google.maps.ControlPosition.LEFT_TOP].push(n),google.maps.event.addListener(Y,"dragend",function(){search_on_map="Yes",I.isOpen()&&(I.close(),I=new InfoBubble({maxWidth:3e3})),e.zoom=Y.getZoom();var t=Y.getZoom(),a=Y.getBounds(),i=a.getSouthWest().lat(),o=a.getSouthWest().lng(),s=a.getNorthEast().lat(),r=a.getNorthEast().lng(),n=a.getCenter().lat(),l=a.getCenter().lng();e.cLat=a.getCenter().lat(),e.cLong=a.getCenter().lng();var c=t+"~"+a+"~"+i+"~"+o+"~"+s+"~"+r+"~"+n+"~"+l;e.map_lat_long=c;var d="";$(".map-auto-refresh-checkbox:checked").each(function(e){d=$(this).val()}),"true"==d?e.search_result():($(".map-auto-refresh").addClass("hide"),$(".map-manual-refresh").removeClass("hide"))}),google.maps.event.addListener(Y,"click",function(){return e.marker_click>0?(e.marker_click=0,!0):void(I.isOpen()&&(I.close(),I=new InfoBubble({maxWidth:3e3})))}),google.maps.event.addListener(Y,"zoom_changed",function(){if("Yes"!=e.map_fit_bounds){search_on_map="Yes",I.isOpen()&&(I.close(),I=new InfoBubble({maxWidth:3e3})),e.zoom=Y.getZoom();var t=Y.getZoom(),a=Y.getBounds(),i=a.getSouthWest().lat(),o=a.getSouthWest().lng(),s=a.getNorthEast().lat(),r=a.getNorthEast().lng(),n=a.getCenter().lat(),l=a.getCenter().lng();e.cLat=a.getCenter().lat(),e.cLong=a.getCenter().lng();var c=t+"~"+a+"~"+i+"~"+o+"~"+s+"~"+r+"~"+n+"~"+l;e.map_lat_long=c;var d="";$(".map-auto-refresh-checkbox:checked").each(function(e){d=$(this).val()}),"true"==d?e.search_result():($(".map-auto-refresh").addClass("hide"),$(".map-manual-refresh").removeClass("hide"))}})}function h(e,t){var a=document.createElement("div");a.style.position="relative",a.style.padding="5px",a.style.margin="-65px 0px 0px 50px",a.style.fontSize="14px",a.innerHTML='<div class="map-refresh-controls google"><a   class="map-manual-refresh btn btn-primary  hide" style="background-color:#ff5a5f;color: #ffffff;">'+$("#redo_search_value").val()+' <i class="icon icon-refresh icon-space-left"></i></a><div class="panel map-auto-refresh"><label class="checkbox"><input type="checkbox" checked="checked" name="redo_search" value="true" class="map-auto-refresh-checkbox"><small>'+$("#current_language").val()+"</small></label></div></div>",e.appendChild(a),google.maps.event.addDomListener(a,"click",function(){})}function g(e,t,a,i){this.pos=e,this.txt_=t,this.cls_=a,this.map_=i,this.div_=null,this.setMap(i)}function u(t){var a=e.checkout,i=e.checkin,o=e.guests;w(null),T=[],angular.forEach(t.data,function(e){var t='<div id="info_window_'+e.id+'" class="listing listing-map-popover" data-price="'+e.rooms_price.currency.symbol+'" data-id="'+e.id+'" data-user="'+e.user_id+'" data-url="/rooms/'+e.id+'" data-name="'+e.name+'" data-lng="'+e.rooms_address.longitude+'" data-lat="'+e.rooms_address.latitude+'"><div class="panel-image listing-img">';t+='<a class="media-photo media-cover" target="listing_'+e.id+'" href="'+APP_URL+"/rooms/"+e.id+"?checkin="+i+"&checkout="+a+"&guests="+o+'"><div class="listing-img-container media-cover text-center"><img id="marker_image_'+e.id+'" rooms_image = "" alt="'+e.name+'" class="img-responsive-height" data-current="0" src="'+APP_URL+"/images/"+e.photo_name+'"></div></a>',t+='<div class="target-prev target-control block-link marker_slider" ng-click="marker_slider($event)"  data-room_id="'+e.id+'"><i class="icon icon-chevron-left icon-size-2 icon-white"></i></div><a class="link-reset panel-overlay-bottom-left panel-overlay-label panel-overlay-listing-label" target="listing_'+e.id+'" href="'+APP_URL+"/rooms/"+e.id+"?checkin="+i+"&checkout="+a+"&guests="+o+'"><div>';var s="";"instant_book"==e.booking_type&&(s='<span aria-label="Book Instantly" data-behavior="tooltip" class="h3 icon-beach"><i class="icon icon-instant-book icon-flush-sides"></i></span>'),t+='<sup class="h6 text-contrast">'+e.rooms_price.currency.symbol+'</sup><span class="h3 text-contrast price-amount">'+e.rooms_price.night+'</span><sup class="h6 text-contrast"></sup>'+s+'</div></a><div class="target-next target-control marker_slider block-link" ng-click="marker_slider($event)" data-room_id="'+e.id+'"><i class="icon icon-chevron-right icon-size-2 icon-white"></i></div></div>',t+='<div class="panel-body panel-card-section"><div class="media"><h3 class="h5 listing-name text-truncate row-space-top-1" itemprop="name" title="'+e.name+'">'+e.name+"</a></h3>";var r="";""!=e.overall_star_rating&&(r=""+e.overall_star_rating);var n="",l=e.reviews_count>1?"s":"";0!=e.reviews_count&&(n=" "+e.reviews_count+" review"+l),t+='<div class="text-muted listing-location text-truncate pull-left" itemprop="description"><a class="text-normal link-reset pull-left" href="'+APP_URL+"/rooms/"+e.id+"?checkin="+i+"&checkout="+a+"&guests="+o+'"><span class="pull-left">'+e.room_type_name+'</span><span class="pull-left dot-cont">·</span><span class="pull-left">'+r+'</span><span class="pull-left dot-cont">·</span><span class="pull-left">'+n+"</span></a></div></div></div></div>";var c=e.rooms_address.latitude,d=e.rooms_address.longitude,m=new google.maps.LatLng(c,d),p=e.name,h=e.rooms_price.currency.symbol,u=e.rooms_price.night,v=new google.maps.Marker({position:m,map:Y,icon:f("normal"),title:p,zIndex:1});customTxt=h+u,"instant_book"==e.booking_type&&(customTxt=h+u+s),txt=new g(m,customTxt,"customBox",Y),T.push(txt),google.maps.event.addListener(v,"mouseover",function(){v.setIcon(f("hover"))}),google.maps.event.addListener(v,"mouseout",function(){v.setIcon(f("normal"))}),_(txt,t)}),angular.forEach(e.place_result,function(t){var a=t.latitude,i=t.longitude,o=new google.maps.LatLng(a,i),s=new Marker({map:Y,position:o,icon:" ",map_icon_label:getMarkerLabel(t.type)});T.push(s),place_info="<p>"+t.name+"</p><p>"+t.address_line_1+" "+t.address_line_2+", "+t.city+"</p><p>"+t.state+", "+t.country+"</p>",e.places_info.push(place_info),E='<div style="font-size:16px"><h3 style="margin:0px; color:#000;">'+t.name+'</h3><div class="popup-review">'+t.reviews_star_rating_div+'</div><div class="address-align">'+t.address_line_1+'</div><div class="address-align">'+t.address_line_2+'</div><div class="address-align">'+t.city+'</div><div class="address-align">'+t.state+'</div><div class="address-align">'+t.country_name+'</div><div class="address-align">'+t.postal_code+"</div>",E+='<br><br><a class="review-btn-pop" href="'+APP_URL+"/add_place_reviews/place/"+t.id+'" target="_blank" >Review</a>',E+='<div class="review-search-popup"><div onclick="reviews_popup(event, this)" class="close" >close</div>',angular.forEach(t.reviews,function(e){E+='<div class="review-content flt-left">',E+='<div class="left-blk review-content-blk" ><img width="40" height="40" src="'+e.users_from.profile_picture.src+'" class="flt-left img-rnd" ></div>',E+='<div class="right-blk review-content-blk" ><div class="place_comments">'+e.place_comments+'</div><div class="place_stars" >'+e.place_review_stars_div+"</div></div>",E+="</div>"}),E+="</div></div></div></div>",v(s,E)})}function _(t,i){I=new InfoBubble({maxWidth:3e3});var o=a(i)(e);google.maps.event.addListener(t,"click",function(){var a=navigator.userAgent;console.log(a),console.log(a.indexOf("iPhone")),a.indexOf("iPhone")==-1&&a.indexOf("iPad")==-1&&a.indexOf("Android")==-1||(e.marker_click=1),I.isOpen()&&(I.close(),I=new InfoBubble({maxWidth:3e3})),I.addTab("",o[0]);var i=0;I.setBorderRadius(i);var s=300;I.setMaxWidth(s);var r=300;I.setMaxHeight(r);var n=282;I.setMinWidth(n);var l=245;I.setMinHeight(l),I.setPosition(t.pos),I.open(Y)})}function v(e,t){I=new InfoBubble({maxWidth:1500});var a=t;google.maps.event.addListener(e,"click",function(){I.isOpen()&&(I.close(),I=new InfoBubble({maxWidth:1500})),I.addTab("",a);var t=0;I.setBorderRadius(t);var i=300;I.setMaxWidth(i);var o=250;I.setMaxHeight(o);var s=300;I.setMinWidth(s);var r=250;I.setMinHeight(r),I.open(Y,e)})}function f(e){var t="";"hover"==e&&(t="");var a=new google.maps.MarkerImage("images/"+t,new google.maps.Size(50,50),new google.maps.Point(0,0),new google.maps.Point(9,20));return a}function w(e){void 0!=I&&I.isOpen()&&(I.close(),I=new InfoBubble({maxWidth:3e3}));for(var t=0;t<T.length;t++)T[t].setMap(e)}e.first_search="Yes",e.current_date=new Date,e.totalPages=0,e.currentPage=1,e.range=[],e.marker_click=0,e.map_lat_long="",e.map_fit_bounds="",$(window).resize(function(){$(window).width()<760?$("#more_filter_submit").html("See Homes"):$("#more_filter_submit").html("Apply filters"),o()}),$(window).ready(function(){$(window).width()<760?$("#more_filter_submit").html("See Homes"):$("#more_filter_submit").html("Apply filters"),o()}),$(window).ready(function(){s()});var k=$("#st_date").val(),b=$("#end_date").val(),y=new Date;start=moment(),$("#checkin").daterangepicker({autoApply:!0,autoUpdateInput:!1,locale:{format:"MMM DD"},minDate:y,dateLimitMin:{days:1},startDate:k,endDate:b}),$("#checkin").on("show.daterangepicker",function(e,t){$(this).parent().parent().find(".DateRangePickerDiv").parent().css("cssText","opacity: 1 !important")}),$("#checkin").on("apply.daterangepicker",function(t,a){startDateInput=$('[name="checkin"]'),endDateInput=$('[name="checkout"]'),startDate=a.startDate,endDate=a.endDate,e.checkin=startDate.format("DD-MM-YYYY"),e.checkout=endDate.format("DD-MM-YYYY"),startDateInput.val(startDate.format("DD-MM-YYYY")),startDateInput.next().html(startDate.format("MMM DD")),endDateInput.val(endDate.format("DD-MM-YYYY")),endDateInput.next().html(endDate.format("MMM DD")),e.search_result()}),$("#checkin").on("hide.daterangepicker",function(e,t){t.startDate&&t.endDate||($(this).parent().css("opacity",1),$(this).parent().parent().find(".DateRangePickerDiv").parent().css("cssText","opacity: 0 !important"))}),$("#checkout").daterangepicker({autoApply:!0,minDate:y,dateLimitMin:{days:1},autoUpdateInput:!1,locale:{format:"MMM DD"},startDate:k,endDate:b}),$("#checkout").on("show.daterangepicker",function(e,t){$(this).parent().parent().find(".DateRangePickerDiv").parent().css("cssText","opacity: 1 !important")}),$("#checkout").on("apply.daterangepicker",function(t,a){startDateInput=$('[name="checkin"]'),endDateInput=$('[name="checkout"]'),startDate=a.startDate,endDate=a.endDate,e.checkin=startDate.format("DD-MM-YYYY"),e.checkout=endDate.format("DD-MM-YYYY"),startDateInput.val(startDate.format("DD-MM-YYYY")),endDateInput.val(endDate.format("DD-MM-YYYY")),e.search_result()}),$("#checkout").on("hide.daterangepicker",function(e,t){t.startDate&&t.endDate||($(this).parent().css("opacity",1),$(this).parent().parent().find(".DateRangePickerDiv").parent().css("cssText","opacity: 0 !important"))}),$(document).on("click",'[id^="wishlist-widget-icon-"]',function(){if("object"==typeof USER_ID)return window.location.href=APP_URL+"/login",!1;var a=$(this).data("name"),i=$(this).data("img"),o=$(this).data("address"),s=$(this).data("host_img");e.room_id=$(this).data("room_id"),$(".background-listing-img").css("background-image","url("+i+")"),$(".host-profile-img").attr("src",s),$(".wl-modal-listing__name").text(a),$(".wl-modal-listing__address").text(o),$(".wl-modal-footer__input").val(o),$(".wl-modal__modal").removeClass("hide"),$(".wl-modal__col:nth-child(2)").addClass("hide"),$(".row-margin-zero").append('<div id="wish-list-signup-container" style="overflow-y:auto;" class="col-lg-5 wl-modal__col-collapsible"> <div class="loading wl-modal__col"> </div> </div>'),t.get(APP_URL+"/wishlist_list?id="+$(this).data("room_id"),{}).then(function(t){$("#wish-list-signup-container").remove(),$(".wl-modal__col:nth-child(2)").removeClass("hide"),e.wishlist_list=t.data})}),e.wishlist_row_select=function(a){t.post(APP_URL+"/save_wishlist",{data:e.room_id,wishlist_id:e.wishlist_list[a].id,saved_id:e.wishlist_list[a].saved_id}).then(function(t){"null"==t.data?e.wishlist_list[a].saved_id=null:e.wishlist_list[a].saved_id=t.data}),$("#wishlist_row_"+a).hasClass("text-dark-gray")?e.wishlist_list[a].saved_id=null:e.wishlist_list[a].saved_id=1},$(document).on("submit",".wl-modal-footer__form",function(a){a.preventDefault(),$(".wl-modal__col:nth-child(2)").addClass("hide"),$(".row-margin-zero").append('<div id="wish-list-signup-container" style="overflow-y:auto;" class="col-lg-5 wl-modal__col-collapsible"> <div class="loading wl-modal__col"> </div> </div>'),t.post(APP_URL+"/wishlist_create",{data:$(".wl-modal-footer__input").val(),id:e.room_id}).then(function(t){$(".wl-modal-footer__form").addClass("hide"),$("#wish-list-signup-container").remove(),$(".wl-modal__col:nth-child(2)").removeClass("hide"),e.wishlist_list=t.data,a.preventDefault()}),a.preventDefault()}),$(".wl-modal-close").click(function(){var t=i("filter")(e.wishlist_list,{saved_id:null});t.length==e.wishlist_list.length?$("#wishlist-widget-"+e.room_id).prop("checked",!1):$("#wishlist-widget-"+e.room_id).prop("checked",!0),$(".wl-modal__modal").addClass("hide")}),$(document).ready(function(){e.map_lat_long="";var t=[];$(".room-type:checked").each(function(e){t[e]=$(this).val()});var a=[];$(".property_type:checked").each(function(e){a[e]=$(this).val()});var i=[];$(".amenities:checked").each(function(e){i[e]=$(this).val()}),$(".search_tag").addClass("hide"),""!=t&&$(".room-type_tag").removeClass("hide"),""!=i&&$(".amenities_tag").removeClass("hide"),""!=a&&$(".property_type_tag").removeClass("hide");var o=$("#location").val();$("#header-search-form").val(o),$("#modal-locations").val(o);var s=document.getElementById("slider"),r=$("html").attr("lang");if("ar"==r)var n="rtl";else var n="ltr";noUiSlider.create(s,{start:[min_slider_price_value,max_slider_price_value],connect:!0,step:1,margin:30,direction:n,range:{min:min_slider_price,max:max_slider_price}});var l=document.getElementById("min_text"),c=document.getElementById("max_text");s.noUiSlider.on("update",function(e,t){t?c.innerHTML=parseInt(e[t]):l.innerHTML=parseInt(e[t])}),s.noUiSlider.on("change",function(t,a){$("#min_value").val(parseInt(t[0])),$("#min_text").val(parseInt(t[0])),max_slider_price==parseInt(t[1])?$("#max_text").html(parseInt(t[1])+"+"):$("#max_text").html(parseInt(t[1])),$("#max_value").val(parseInt(t[1])),e.search_result(),console.log(t)}),$(".show-more").click(function(){$(this).children("span").toggleClass("hide"),$(this).parent().parent().children("div").children().toggleClass("filters-more")}),$("#more_filters").click(function(){$(".toggle-group").css("display","block"),$(".toggle-hide").css("display","none"),$(".sidebar").css("height","87%")})});d("location"),window.location.href.replace("/s","/searchResult");pageNumber=1,void 0===pageNumber&&(pageNumber="1"),$(".search-results").addClass("loading"),n(),r(),e.on_mouse=function(e){void 0!=T[e]&&(mark=T[e].div_,$(mark).addClass("hover"))},e.out_mouse=function(e){void 0!=T[e]&&(mark=T[e].div_,$(mark).removeClass("hover"))},e.setParams=function(){var e=$("#max_value").val(),t=$("#min_value").val();c("min_price",t),c("max_price",e)},e.search_result=function(a){void 0===a&&(a="1");var i=$("#max_value").val(),o=$("#min_value").val(),s=[];$(".room-type:checked").each(function(e){s[e]=$(this).val()}),""==s&&$(".room-type_tag").addClass("hide");var m=[];$(".property_type:checked").each(function(e){m[e]=$(this).val()}),""==m&&$(".property_type_tag").addClass("hide");var h=[];$(".amenities:checked").each(function(e){h[e]=$(this).val()}),""==h&&$(".amenities_tag").addClass("hide");var g=e.checkin,_=e.checkout,v=$("#map-search-min-beds").val(),f=$("#map-search-min-bathrooms").val(),w=$("#map-search-min-bedrooms").val(),k=$("#guest-select").val();if(null!=k&&""!=k||(k=1),""!=$.trim(e.map_lat_long)&&""!=search_on_map)var b=e.map_lat_long;else var b="";instant_book=1==$("#instant_book:checked").val()?1:0,c("room_type",s),c("property_type",m),c("amenities",h),c("checkin",g),c("checkout",_),c("guests",k),c("beds",v),c("bathrooms",f),c("bedrooms",w),c("min_price",o),c("max_price",i),c("page",a),c("instant_book",instant_book),$(".search_tag").addClass("hide"),""!=s&&$(".room-type_tag").removeClass("hide"),""!=h&&$(".amenities_tag").removeClass("hide"),""!=m&&$(".property_type_tag").removeClass("hide");var y=d("location");$(".search-results").addClass("loading"),n(),r(),t.post("searchResult?page="+a,{location:y,min_price:o,max_price:i,amenities:h,property_type:m,room_type:s,beds:v,bathrooms:f,bedrooms:w,checkin:g,checkout:_,guest:k,map_details:b,instant_book:instant_book}).then(function(t){e.room_result=t.data,e.checkin=g,e.checkout=_,e.totalPages=t.data.last_page,e.currentPage=t.data.current_page;for(var a=[],i=1;i<=t.data.last_page;i++)a.push(i);var o=d("amenities"),s=d("property_type");$(window).width()>760&&(""!=o&&""!=s||$("#more_filter_submit").attr("disabled","disabled")),e.range=a;var n=new google.maps.LatLngBounds;angular.forEach(t.data.data,function(e,t){var a=e.rooms_address.latitude,i=e.rooms_address.longitude;n.extend(new google.maps.LatLng(a,i))}),e.map_fit_bounds="Yes",($(window).width()>760||"Yes"!=e.first_search)&&(t.data.total>0&&""==search_on_map?(e.viewport=n,e.cLat=t.data.data[0].rooms_address.latitude,e.cLong=t.data.data[0].rooms_address.longitude,map_search_first="Yes",p(n)):""==search_on_map&&(e.viewport=e.locationViewport,e.cLat=e.locationLat,e.cLong=e.locationLong,p())),$(".search-results").removeClass("loading"),l(),r(),u(t.data)})},e.apply_filter=function(){$(window).width()<760?($(".search-results").show(),$(".filter-div").hide()):($('[id^="map-search"]').each(function(){$(this).hasClass("property_type")&&1==$(this).prop("checked")?prop_app_fil=""==prop_app_fil?$(this).val():prop_app_fil+","+$(this).val():$(this).hasClass("amenities")&&1==$(this).prop("checked")&&(amen_app_fil=""==amen_app_fil?$(this).val():amen_app_fil+","+$(this).val())}),broom_app_fil=$("#map-search-min-bedrooms").val(),bath_app_fil=$("#map-search-min-bathrooms").val(),bed_app_fil=$("#map-search-min-beds").val(),$(".toggle-hide").css("display","block"),$(".toggle-group").css("display","none"),e.search_result())},e.remove_filter=function(t){$("."+t).removeAttr("checked");var a=t.replace("-","_"),i="";c(a,i),$("."+t+"_tag").addClass("hide"),e.search_result()};var x,C=e.locationViewport=JSON.parse($("#viewport").val()),D="",L="",P="",M="",I=new InfoBubble({maxWidth:3e3});angular.forEach(C,function(e,t){D=C.southwest.lat,L=C.southwest.lng,P=C.northeast.lat,M=C.northeast.lng});var x=new google.maps.LatLngBounds(new google.maps.LatLng(D,L),new google.maps.LatLng(P,M));e.viewport=e.locationViewport=x,setTimeout(function(){m(),e.map_lat_long=""},1e3),e.zoom="",e.cLat="",e.cLong="",e.locationLat="",e.locationLong="";var Y,E="",T=[];new google.maps.InfoWindow({content:E});$(document).ready(function(){e.search_result()}),g.prototype=new google.maps.OverlayView,g.prototype.onAdd=function(){var e=document.createElement("DIV");e.className=this.cls_,e.innerHTML=this.txt_,this.div_=e;var t=this.getProjection(),a=t.fromLatLngToDivPixel(this.pos);e.style.left=a.x-25+"px",e.style.top=a.y-25+"px";var i=this.getPanes();i.overlayMouseTarget.appendChild(e);var o=this;google.maps.event.addDomListener(e,"click",function(e){google.maps.event.trigger(o,"click"),e.stopPropagation()}),google.maps.event.addDomListener(e,"dblclick",function(e){e.stopPropagation()})},g.prototype.draw=function(){var e=this.getProjection(),t=e.fromLatLngToDivPixel(this.pos),a=this.div_;a.style.left=t.x-25+"px",a.style.top=t.y-25+"px",a.style.position="absolute",a.style.cursor="pointer"},g.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},g.prototype.hide=function(){this.div_&&(this.div_.style.visibility="hidden")},g.prototype.show=function(){this.div_&&(this.div_.style.visibility="visible")},g.prototype.toggle=function(){this.div_&&("hidden"==this.div_.style.visibility?this.show():this.hide())},g.prototype.toggleDOM=function(){this.getMap()?this.setMap(null):this.setMap(this.map_)},$(".footer-toggle").click(function(){$(".footer-container").slideToggle("fast",function(){$(".footer-container").is(":visible")?($(".open-content").hide(),$(".close-content").show()):($(".open-content").show(),$(".close-content").hide())})}),$(document).on("click",".map-manual-refresh",function(){$(".map-manual-refresh").addClass("hide"),$(".map-auto-refresh").removeClass("hide"),e.search_result()}),$(document).on("click",".rooms-slider",function(){var e=$(this).attr("data-room_id"),a=$("#rooms_image_"+e).attr("rooms_image"),i=$("#rooms_image_"+e).attr("src");if(""==$.trim(a))$(this).parent().addClass("loading"),t.post("rooms_photos",{rooms_id:e}).then(function(t){angular.forEach(t.data,function(e){a=""==$.trim(a)?e.name:a+","+e.name}),$("#rooms_image_"+e).attr("rooms_image",a);var o=i.split("rooms/"+e+"/"),s=a.split(","),r=s.length,n=0,l="";if(angular.forEach(s,function(e){$.trim(e)==$.trim(o[1])&&(l=n),n++}),1==$(this).is(".target-prev"))var c=l-1,d=r-1;else var c=l+1,d=0;if("undefined"!=typeof s[c]&&"null"!=$.trim(s[c]))var m=s[c];else var m=s[d];var p=o[0]+"rooms/"+e+"/"+m;$(".panel-image").removeClass("loading"),$("#rooms_image_"+e).attr("src",p)});else{$(this).parent().addClass("loading");var o=i.split("rooms/"+e+"/"),s=a.split(","),r=s.length,n=0,l="";if(angular.forEach(s,function(e){$.trim(e)==$.trim(o[1])&&(l=n),n++}),1==$(this).is(".target-prev"))var c=l-1,d=r-1;else var c=l+1,d=0;if("undefined"!=typeof s[c]&&"null"!=$.trim(s[c]))var m=s[c];else var m=s[d];var p=o[0]+"rooms/"+e+"/"+m;$(".panel-image").removeClass("loading"),$("#rooms_image_"+e).attr("src",p)}}),e.marker_slider=function(e){e.stopPropagation();var a=(angular.element(e.currentTarget),$(e.currentTarget).attr("data-room_id")),i=$("#marker_image_"+a).attr("rooms_image"),o=$("#marker_image_"+a).attr("src");if(""==$.trim(i))$(e.currentTarget).parent().addClass("loading"),t.post("rooms_photos",{rooms_id:a}).then(function(t){angular.forEach(t.data,function(e){i=""==$.trim(i)?e.name:i+","+e.name}),$("#marker_image_"+a).attr("rooms_image",i);var s=o.split("rooms/"+a+"/"),r=i.split(","),n=r.length,l=0,c="";if(angular.forEach(r,function(e){$.trim(e)==$.trim(s[1])&&(c=l),l++}),1==$(e.currentTarget).is(".target-prev"))var d=c-1,m=n-1;else var d=c+1,m=0;if("undefined"!=typeof r[d]&&"null"!=$.trim(r[d]))var p=r[d];else var p=r[m];var h=s[0]+"rooms/"+a+"/"+p;$(".panel-image").removeClass("loading"),$("#marker_image_"+a).attr("src",h)});else{$(e.currentTarget).parent().addClass("loading");var s=o.split("rooms/"+a+"/"),r=i.split(","),n=r.length,l=0,c="";if(angular.forEach(r,function(e){$.trim(e)==$.trim(s[1])&&(c=l),l++}),1==$(e.currentTarget).is(".target-prev"))var d=c-1,m=n-1;else var d=c+1,m=0;if("undefined"!=typeof r[d]&&"null"!=$.trim(r[d]))var p=r[d];else var p=r[m];var h=s[0]+"rooms/"+a+"/"+p;$(".panel-image").removeClass("loading"),$("#marker_image_"+a).attr("src",h)}},$(document).on("click",".marker_slider",function(e){var a=$(this).attr("data-room_id"),i=$("#marker_image_"+a).attr("rooms_image"),o=$("#marker_image_"+a).attr("src");if(""==$.trim(i))$(this).parent().addClass("loading"),t.post("rooms_photos",{rooms_id:a}).then(function(e){angular.forEach(e.data,function(e){i=""==$.trim(i)?e.name:i+","+e.name}),$("#marker_image_"+a).attr("rooms_image",i);var t=o.split("rooms/"+a+"/"),s=i.split(","),r=s.length,n=0,l="";if(angular.forEach(s,function(e){$.trim(e)==$.trim(t[1])&&(l=n),n++}),1==$(this).is(".target-prev"))var c=l-1,d=r-1;else var c=l+1,d=0;if("undefined"!=typeof s[c]&&"null"!=$.trim(s[c]))var m=s[c];else var m=s[d];var p=t[0]+"rooms/"+a+"/"+m;$(".panel-image").removeClass("loading"),$("#marker_image_"+a).attr("src",p)});else{$(this).parent().addClass("loading");var s=o.split("rooms/"+a+"/"),r=i.split(","),n=r.length,l=0,c="";if(angular.forEach(r,function(e){$.trim(e)==$.trim(s[1])&&(c=l),l++}),1==$(this).is(".target-prev"))var d=c-1,m=n-1;else var d=c+1,m=0;if("undefined"!=typeof r[d]&&"null"!=$.trim(r[d]))var p=r[d];else var p=r[m];var h=s[0]+"rooms/"+a+"/"+p;$(".panel-image").removeClass("loading"),$("#marker_image_"+a).attr("src",h)}}),$(document).on("change",'[id^="map-search"]',function(){var e=d("amenities"),t=d("property_type"),a=0;$('[id^="map-search"]').each(function(){$(this).is(":checkbox")?$(this).is(":checked")?a++:""==e&&""==t||a++:""!=$(this).val()&&a++}),0==a?$(window).width()<760?$("#more_filter_submit").removeAttr("disabled"):$("#more_filter_submit").attr("disabled","disabled"):$("#more_filter_submit").removeAttr("disabled")}),$(document).on("click","#cancel-filter",function(){var t=prop_app_fil.split(","),a=amen_app_fil.split(",");$('[id^="map-search"]').each(function(){$(this).is(":checkbox")?$(window).width()>760&&("-1"!=jQuery.inArray($(this).val(),t)&&$(this).hasClass("property_type")||"-1"!=jQuery.inArray($(this).val(),a)&&$(this).hasClass("amenities")?$(this).prop("checked",!0):$(this).prop("checked",!1)):$(window).width()>760&&$(this).val("")}),$(window).width()>760&&($("#map-search-min-bedrooms").val(broom_app_fil),$("#map-search-min-bathrooms").val(bath_app_fil),$("#map-search-min-beds").val(bed_app_fil)),$("#more_filter_submit").attr("disabled","disabled"),$(".toggle-hide").css("display","block"),$(".toggle-group").css("display","none"),$(".filter-div").hide(),$(".button_ipunk").show(),$(".button_ipunk4").show(),$(".sidebar").css("height","100%"),e.search_result()})}]),$(".show-filters").click(function(){$(".sidebar").addClass("fixed-hieght")}),$("#cancel-filter").click(function(){$(".sidebar").removeClass("fixed-hieght")}),$("#more_filter_submit").click(function(){$(window).width()<480&&($(".filter-div").hide(),$(".button_ipunk").show(),$(".button_ipunk4").show())});